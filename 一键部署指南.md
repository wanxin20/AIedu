# ä¸€é”®éƒ¨ç½²æŒ‡å— - æ™ºæ…§æ•™è¾…ç³»ç»Ÿ

åŸŸåï¼šedu.gptpro.cn  
ç«¯å£ï¼š3003ï¼ˆä»…ç”¨äºå¤‡é€‰æ–¹æ¡ˆï¼‰  
æ¨èï¼š**Nginx é™æ€æ‰˜ç®¡**

---

## âš¡ æœ€å¿«éƒ¨ç½²æ–¹å¼ï¼ˆ3 æ­¥å®Œæˆï¼‰

### ç¬¬ 1 æ­¥ï¼šæœåŠ¡å™¨ç¯å¢ƒå‡†å¤‡

SSH è¿æ¥åˆ°æœåŠ¡å™¨åï¼Œè¿è¡Œï¼š

```bash
# ä¸‹è½½å¹¶è¿è¡ŒæœåŠ¡å™¨é…ç½®è„šæœ¬ï¼ˆæˆ–æ‰‹åŠ¨ä¸Šä¼  server-setup.shï¼‰
curl -O https://your-domain/server-setup.sh
chmod +x server-setup.sh
sudo ./server-setup.sh
```

æˆ–æ‰‹åŠ¨å®‰è£…ï¼š
```bash
sudo apt update
sudo apt install nginx -y
sudo mkdir -p /var/www/edu-platform
sudo chown -R www-data:www-data /var/www/edu-platform
```

### ç¬¬ 2 æ­¥ï¼šæœ¬åœ°æ„å»ºå’Œéƒ¨ç½²

**ä¿®æ”¹ deploy.shï¼š**
```bash
# ç¼–è¾‘ deploy.shï¼Œä¿®æ”¹æœåŠ¡å™¨ä¿¡æ¯
vim deploy.sh

# æ‰¾åˆ°è¿™ä¸€è¡Œï¼Œæ”¹æˆä½ çš„æœåŠ¡å™¨ IP
SERVER_HOST="123.45.67.89"  # æ”¹æˆå®é™…IP
```

**è¿è¡Œéƒ¨ç½²è„šæœ¬ï¼š**
```bash
# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡ï¼‰
npm install

# ä¸€é”®éƒ¨ç½²
./deploy.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆï¼š
- âœ… æ¸…ç†æ—§æ–‡ä»¶
- âœ… æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- âœ… ä¸Šä¼ åˆ°æœåŠ¡å™¨
- âœ… è®¾ç½®æƒé™
- âœ… é‡å¯ Nginx

### ç¬¬ 3 æ­¥ï¼šé…ç½® Nginx

åœ¨æœåŠ¡å™¨ä¸Šï¼š

```bash
# 1. åˆ›å»º Nginx é…ç½®ï¼ˆæˆ–æ‰‹åŠ¨åˆ›å»ºå¹¶ä¸Šä¼  nginx.confï¼‰
sudo nano /etc/nginx/sites-available/edu.gptpro.cn

# ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š
server {
    listen 80;
    server_name edu.gptpro.cn;
    root /var/www/edu-platform;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}

# 2. å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/edu.gptpro.cn /etc/nginx/sites-enabled/

# 3. æµ‹è¯•å¹¶é‡å¯
sudo nginx -t
sudo systemctl restart nginx
```

### å®Œæˆï¼ğŸ‰

è®¿é—® http://edu.gptpro.cn æŸ¥çœ‹æ•ˆæœã€‚

---

## ğŸ” é…ç½® SSLï¼ˆå¯é€‰ä½†å¼ºçƒˆæ¨èï¼‰

```bash
# å®‰è£… Certbot
sudo apt install certbot python3-certbot-nginx -y

# è‡ªåŠ¨é…ç½® SSL
sudo certbot --nginx -d edu.gptpro.cn

# æŒ‰æç¤ºè¾“å…¥é‚®ç®±å¹¶åŒæ„åè®®
```

é…ç½®å®Œæˆåï¼Œç½‘ç«™ä¼šè‡ªåŠ¨é‡å®šå‘åˆ° HTTPSã€‚

---

## ğŸ“‹ å®Œæ•´éƒ¨ç½²æ£€æŸ¥æ¸…å•

### æœåŠ¡å™¨ç«¯
- [ ] Nginx å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] åˆ›å»ºäº† `/var/www/edu-platform` ç›®å½•
- [ ] æƒé™è®¾ç½®ä¸º `www-data:www-data`
- [ ] Nginx é…ç½®æ–‡ä»¶å·²åˆ›å»º
- [ ] é…ç½®æ–‡ä»¶å·²é“¾æ¥åˆ° sites-enabled
- [ ] Nginx é…ç½®æµ‹è¯•é€šè¿‡ï¼ˆ`nginx -t`ï¼‰

### æœ¬åœ°ç«¯
- [ ] é¡¹ç›®ä¾èµ–å·²å®‰è£…ï¼ˆ`npm install`ï¼‰
- [ ] æ„å»ºæˆåŠŸï¼ˆ`npm run build`ï¼‰
- [ ] `deploy.sh` ä¸­çš„æœåŠ¡å™¨ IP å·²ä¿®æ”¹
- [ ] éƒ¨ç½²è„šæœ¬å·²æ‰§è¡Œ

### DNS é…ç½®
- [ ] åŸŸå A è®°å½•æŒ‡å‘æœåŠ¡å™¨ IP
- [ ] DNS è§£æå·²ç”Ÿæ•ˆï¼ˆ`ping edu.gptpro.cn`ï¼‰

### éªŒè¯
- [ ] ç½‘ç«™å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] è·¯ç”±è·³è½¬æ­£å¸¸ï¼ˆSPA è·¯ç”±ï¼‰
- [ ] é™æ€èµ„æºåŠ è½½æ­£å¸¸
- [ ] SSL è¯ä¹¦æœ‰æ•ˆï¼ˆå¦‚å·²é…ç½®ï¼‰

---

## ğŸ”„ æ—¥å¸¸æ›´æ–°éƒ¨ç½²

ä¿®æ”¹ä»£ç åï¼Œåªéœ€è¿è¡Œï¼š

```bash
./deploy.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆæ„å»ºå’Œéƒ¨ç½²ã€‚

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `deploy.sh` | æœ¬åœ°éƒ¨ç½²è„šæœ¬ï¼Œè‡ªåŠ¨æ„å»ºå¹¶ä¸Šä¼  |
| `server-setup.sh` | æœåŠ¡å™¨ç¯å¢ƒé…ç½®è„šæœ¬ |
| `nginx.conf` | Nginx å®Œæ•´é…ç½®æ–‡ä»¶ |
| `ecosystem.config.js` | PM2 é…ç½®æ–‡ä»¶ï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰ |
| `DEPLOY_README.md` | è¯¦ç»†éƒ¨ç½²æ–‡æ¡£ |
| `deploy.md` | å®Œæ•´éƒ¨ç½²æŒ‡å—ï¼ˆåŒ…å«ä¸¤ç§æ–¹æ¡ˆï¼‰ |

---

## â“ å¸¸è§é—®é¢˜

### Q1: è®¿é—®æ˜¾ç¤º Nginx é»˜è®¤é¡µé¢ï¼Ÿ
**A:** æ£€æŸ¥ Nginx é…ç½®æ˜¯å¦æ­£ç¡®å¯ç”¨ï¼š
```bash
ls -la /etc/nginx/sites-enabled/
sudo systemctl restart nginx
```

### Q2: é¡µé¢åˆ·æ–°å 404ï¼Ÿ
**A:** ç¡®ä¿ Nginx é…ç½®åŒ…å« SPA è·¯ç”±æ”¯æŒï¼š
```nginx
location / {
    try_files $uri $uri/ /index.html;
}
```

### Q3: éƒ¨ç½²è„šæœ¬è¿æ¥å¤±è´¥ï¼Ÿ
**A:** æ£€æŸ¥ï¼š
1. æœåŠ¡å™¨ IP æ˜¯å¦æ­£ç¡®
2. SSH å¯†é’¥æ˜¯å¦é…ç½®
3. é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 22 ç«¯å£

### Q4: SSL è¯ä¹¦ç”³è¯·å¤±è´¥ï¼Ÿ
**A:** ç¡®ä¿ï¼š
1. åŸŸåå·²æ­£ç¡®è§£æåˆ°æœåŠ¡å™¨
2. 80 ç«¯å£å¯è®¿é—®
3. æ²¡æœ‰å…¶ä»–è¯ä¹¦å†²çª

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

**æŸ¥çœ‹æ—¥å¿—ï¼š**
```bash
# Nginx é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log

# Nginx è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log
```

**æµ‹è¯•é…ç½®ï¼š**
```bash
# æµ‹è¯• Nginx é…ç½®
sudo nginx -t

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload nginx
```

**æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š**
```bash
# Nginx çŠ¶æ€
sudo systemctl status nginx

# æŸ¥çœ‹ç«¯å£å ç”¨
sudo lsof -i :80
sudo lsof -i :443
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. é”™è¯¯ä¿¡æ¯æˆ–æˆªå›¾
2. Nginx é”™è¯¯æ—¥å¿—
3. æœåŠ¡å™¨ç³»ç»Ÿä¿¡æ¯ï¼ˆ`uname -a`ï¼‰
4. Nginx ç‰ˆæœ¬ï¼ˆ`nginx -v`ï¼‰

ç¥éƒ¨ç½²é¡ºåˆ©ï¼ğŸš€

